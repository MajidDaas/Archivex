<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Org File Portal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div id="app" class="container">
        <!-- Auth Section -->
        <section id="auth-section" class="auth-section" style="display: none;">
            <div class="auth-card">
                <h1 class="auth-title">üîê Organization File Portal</h1>
                <p class="auth-subtitle">Secure access to your team‚Äôs documents.</p>

                {% if error %}
                    <div class="flash-message error">{{ error }}</div>
                {% endif %}

                <!-- Main Google Login Button -->
                <a id="login-btn" class="btn btn-primary btn-large">Login with Google</a>

                <!-- Demo Login Section -->
                <div class="demo-login-section">
                    <h2 class="demo-title">üß™ Demo Login (For Testing)</h2>
                    <p class="demo-description">Select a predefined user to simulate login:</p>

                    {% if demo_users %}
                        <form method="post" action="/demo_login" class="demo-form">
                            <select name="email" id="demo-email-select" class="form-input" required>
                                <option value="" disabled selected>Select a test user</option>
                                {% for user_email in demo_users %}
                                    <option value="{{ user_email }}">{{ user_email }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit" class="btn btn-secondary">Demo Login</button>
                        </form>
                    {% else %}
                        <p class="demo-description">No demo users configured.</p>
                    {% endif %}
                </div>
            </div>
        </section>

        <!-- Main App -->
        <main id="main-app" class="main-app" style="display: none;">
            <header class="app-header">
                <h1 class="app-title">üìÅ Organization File Portal</h1>
                <button id="logout-btn" class="btn btn-outline">Logout</button>
            </header>

            <div id="user-email" class="user-info"></div>

            <!-- Flash Messages Container -->
            <div id="flash-container" class="flash-messages"></div>

            <!-- Navigation Tabs -->
            <nav id="tabs-container" class="tabs"></nav>

            <!-- Active Tab Content -->
            <section id="tab-content" class="tab-content">
                <header id="tab-header" class="tab-header">
                    <h2 id="tab-title" class="tab-title"></h2>
                    <p id="tab-description" class="tab-description"></p>
                </header>

                <!-- Upload Section -->
                <section class="upload-section">
                    <div class="form-group">
                        <label for="file-upload" class="upload-label">Choose a file:</label>
                        <input type="file" id="file-upload" class="form-input-file" />
                    </div>
                    <button id="upload-btn" class="btn btn-primary">Upload File</button>
                </section>

                <!-- Search Section -->
                <section class="search-section">
                    <div class="form-group">
                        <input type="text" id="search-input" placeholder="Search files by name or content..." class="form-input" />
                        <button id="search-btn" class="btn btn-search">üîç Search</button>
                    </div>
                </section>

                <!-- Files List Area -->
                <section class="files-section">
                    <div id="loading" class="loading-indicator" style="display: none;">
                        <span class="spinner"></span> Loading files...
                    </div>
                    <ul id="files-list" class="file-list"></ul>
                    <div id="no-files" class="no-files-message" style="display: none;">
                        <p>üì≠ No files found in this folder.</p>
                        <p>Try uploading a file or adjusting your search.</p>
                    </div>
                </section>
            </section>
        </main>
    </div>

    <!-- ‚úÖ PASS AUTH URL FROM FLASK TO JAVASCRIPT -->
    <script>
        window.APP_CONFIG = {
            authUrl: {{ auth_url|tojson }}
        };
        console.log("üîß [DEBUG] Auth URL received from backend:", window.APP_CONFIG.authUrl);
    </script>
    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
